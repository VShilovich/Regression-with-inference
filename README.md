# Отчёт о разработке линейной модели прогнозирования стоимости автомобилей

## 1. Что было сделано
Был проведен полный цикл разработки ML-решения:
1.  **Разведочный анализ данных (EDA):**
    *   Выявлены и обработаны пропуски и дубликаты.
    *   Выполнен парсинг сложного признака `torque` (разделение на крутящий момент и обороты), очистка `mileage`, `engine`, `max_power` от единиц измерения.
    *   Проведен анализ основных статистик числовых и категориальных признаков.
    *   Сделана визуализация корреляций и других интересующих графиков.
2.  **Feature Engineering:**
    *   Выполнена предобработка категориального признака `name` путём извлечения марки автомобиля.
    *   Категориальные признаки закодированы через `OneHotEncoding`.
    *   Вещественные признаки стандартизированы через `StandardScaler`.
3.  **Моделирование:**
    *   Обучена модель классической линейной регрессии с дефолтными параметрами на вещественных признаках.
    *   Проведены эксперименты с регуляризациями (Lasso, Ridge, ElasticNet).
    *   Подобраны оптимальные гиперпараметры через `GridSearchCV`.
    *   Реализована бизнес-метрика (доля предиктов с ошибкой <10%).

## 2. Результаты
По результатам сравнения качества таких моделей как классическая линейная регрессия (с дефолтными параметрами, обученная на вещественных признаках), линейная регрессия с Lasso регуляризацией (обученная на вещественных признаках), и линейная регрессия с Ridge регуляризацией (обученная и на вещественных, и на категориальных признаках), можно сделать вывод о том, что наилучшей оказалась последняя из приведенных моделей.

Линейная модель с L2-регуляризацией, обученная на вещественных и категориальных признаках, показала наилучший результат по всем метрикам (RMSE: ~357 000, R2: 0.78, бизнес метрика: 0.296). Данная модель превосходит базовое решение по R2 метрике на 30% и позволяет корректно оценивать на 23% больше автомобилей согласно бизнес-метрике (относительный прирост).

## 3. Что дало наибольший буст в качестве
Наибольший буст качества дало добавление категориальных признаков. Модель, обученная только на вещественных признаках, то есть, исключительно физических характеристиках, относилась ко всем авто утилитарно. Другими словами, если автомобили Audi и Skoda будут обладать одинаковыми характеристиками, такая модель предсказала бы одинаковую стоимость для них. В реальности же, для Audi будет существенная наценка на бренд по сравнению со Skoda. Модель, обученная также на категориальных признаках, учитывает это.

## 4. Что сделать не вышло и почему
1.  Изначально Lasso регуляризация не занулила веса, так как масштаб функции потерь был несоизмерим со штрафом. Проблема была решена подбором гиперпараметра `alpha`.
2.  Регуляризация ElasticNet не дала прироста качества по сравнению с чистой Lasso регуляризацией. Оптимизатор выбрал `l1_ratio=1.0`, что фактически превратило ElasticNet обратно в Lasso. Это говорит о том, что для задачи отбора признаков достаточно L1-регуляризации.
3.  Значения метрик получились далекими от идеальных. Бизнес метрика и вовсе получилась очень низкой. Для дальнейшего улучшения требуется логарифмирование целевой переменной. В любом случае, линейная модель упрется в потолок линейного алгоритма и не даст очень существенного прироста в качестве. Для того, чтобы получить наилучшие результаты, для данной задачи стоит использовать нелинейную модель.
